<!doctype html>
<html lang="ja">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
	<link rel="apple-touch-icon" href="icon.png">
	<title>XEMMessage</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css" />
	<link rel="stylesheet" href="style.css" />
	<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-100421513-1', 'auto');
	ga('send', 'pageview');
	</script>
</head>
<body>
	<h1>XEMMessage</h1>
	<hr class="zigzag-orange-white">
<div class="container">
	<div class="row">
	<div class="account col-sm-4">
	<h2>アカウント</h2>
	<dl id="account_info">
		<dt>アドレス</dt><dd><span id="account_address"></span></dd>
		<dt>残高</dt><dd><span id="account_balance"></span></dd>
	</dl>

	</div>
	<div class="account col-sm-4">
	</div>
	<div class="account col-sm-4">
	<h2>トランザクション</h2>
	<table id="table"  class="table">
		<thead><tr>
			<th>日時</th>
			<th>区分</th>
			<th>数量</th>
		</tr></thead>
	</table>
	<dd id="transfers_footer"><a id="transfers_more" href="javascript:void(0)" >さらに読み込む</a></dd>
	</div>
	</div>
</div>



<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
<script src="symbol-sdk-1.0.0.min.js"></script>
<script src="xembook.js"></script>
<script>

function getNewInfo(height){}
function appendAccountInfo(amount){}
function dispInfo(accountInfo){
	accountInfo.subscribe(_=>{
		getTransfers();
	});
}



function appendAggTx(tx){

	const id = tx.transactionInfo.id;
	$("#table").append("<tr id='agg" + id + "'>"
	+ "<td><a target='_blank' href='http://explorer.symbolblockchain.io/transactions/"
	+ tx.transactionInfo.hash + "'><span id='date" + id + "'>"
	+ "</span></a></td>"
	+ "<td id='type" + id + "'></td>" //mosaicLabel
	+ "<td id='amount" + id + "' class='text-right'></td>"
	+ "</tr>"
	);

	blockRepo.getBlockByHeight(tx.transactionInfo.height)
	.subscribe(b => {

		$("#date"+ id).text(
			dispTimeStamp(Number(b.timestamp.toString()),epochAdjustment)
		);
	})
}

function appendTx(insTag,tx,id){

	$(insTag).append(
		"<tr>"
		+ "<td><a target='_blank' href='http://explorer.symbolblockchain.io/transactions/"
		   + tx.transactionInfo.hash + "'><span id='date" + id + "'>"
		+ "</span></a></td>"
		+ "<td id='type" + id + "'></td>" //mosaicLabel
		+ "<td id='amount" + id + "' class='text-right'></td>"
		+ "</tr>"
	);

	blockRepo.getBlockByHeight(tx.transactionInfo.height)
	.subscribe(b => {

		$("#date"+ id).text(
			dispTimeStamp(Number(b.timestamp.toString()),epochAdjustment)
		);
	})
}

function insertTxAfter(insTag,id){

	$(insTag).after(
		"<tr>"
		+ "<td></td>"
		+ "<td id='type" + id + "'></td>" //mosaicLabel
		+ "<td id='amount" + id + "'  class='text-right'></td>"
		+ "</tr>"
	);
}


$('#transfers_more').click(function(){getTransfers();return false;});
</script>
</body>
</html>
